{"ast":null,"code":"var _jsxFileName = \"/usr/src/app/src/components/post/UserModal.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport Modal from '@material-ui/core/Modal';\nimport { Grid, Typography } from \"@material-ui/core\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Button from \"@material-ui/core/Button\";\nimport Divider from \"@material-ui/core/Divider\";\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\nimport FavoriteBorderIcon from \"@material-ui/icons/FavoriteBorder\";\nimport { getUsers } from \"lib/api/users\";\nimport { getLikes, createLike } from \"lib/api/likes\";\nimport { AuthContext } from \"App\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction getModalStyle() {\n  const top = 50;\n  const left = 50;\n  return {\n    top: `${top}%`,\n    left: `${left}%`,\n    transform: `translate(-${top}%, -${left}%)`\n  };\n}\n\nconst useStyles = makeStyles(theme => createStyles({\n  paper: {\n    position: 'absolute',\n    width: 480,\n    backgroundColor: theme.palette.background.paper,\n    border: '2px solid #000',\n    boxShadow: theme.shadows[5],\n    padding: theme.spacing(6, 8, 7)\n  },\n  button: {\n    color: \"#f87ede\"\n  },\n  avatar: {\n    width: theme.spacing(10),\n    height: theme.spacing(10)\n  },\n  card: {\n    width: 480,\n    marginTop: \"2rem\",\n    transition: \"all 0.3s\",\n    \"&:hover\": {\n      boxShadow: \"1px 0px 20px -1px rgba(0,0,0,0.2), 0px 0px 20px 5px rgba(0,0,0,0.14), 0px 1px 10px 0px rgba(0,0,0,0.12)\",\n      transform: \"translateY(-3px)\"\n    }\n  }\n}));\nconst {\n  currentUser\n} = useContext(AuthContext);\nconst initialUserState = {\n  id: 0,\n  uid: \"\",\n  provider: \"\",\n  email: \"\",\n  name: \"\",\n  image: {\n    url: \"\"\n  },\n  profile: \"\",\n  allowPasswordChange: true\n};\nconst [loading, setLoading] = useState(true);\nconst [users, setUsers] = useState([]);\nconst [user, setUser] = useState(initialUserState);\nconst [userDetailOpen, setUserDetailOpen] = useState(false);\nconst [likedUsers, setLikedUsers] = useState([]);\nconst [likes, setLikes] = useState([]);\nconst [alertMessageOpen, setAlertMessageOpen] = useState(false); // フォームデータを作成\n\nconst createFormData = () => {\n  const formData = new FormData();\n  formData.append(\"fromUserId\", String(currentUser === null || currentUser === void 0 ? void 0 : currentUser.id));\n  formData.append(\"toUserId\", String(user.id));\n  return formData;\n}; // いいね作成\n\n\nconst handleCreateLike = async user => {\n  const data = createFormData();\n\n  try {\n    const res = await createLike(data);\n    console.log(res);\n\n    if ((res === null || res === void 0 ? void 0 : res.status) === 200) {\n      setLikes([res.data.like, ...likes]);\n      setLikedUsers([user, ...likedUsers]);\n      console.log(res === null || res === void 0 ? void 0 : res.data.like);\n    } else {\n      console.log(\"Failed\");\n    }\n\n    if ((res === null || res === void 0 ? void 0 : res.data.isMatched) === true) {\n      setAlertMessageOpen(true);\n      setUserDetailOpen(false);\n    }\n  } catch (err) {\n    console.log(err);\n  }\n}; // ユーザー一覧を取得\n\n\nconst handleGetUsers = async () => {\n  try {\n    const res = await getUsers();\n    console.log(res);\n\n    if ((res === null || res === void 0 ? void 0 : res.status) === 200) {\n      setUsers(res === null || res === void 0 ? void 0 : res.data.users);\n    } else {\n      console.log(\"No users\");\n    }\n  } catch (err) {\n    console.log(err);\n  }\n\n  setLoading(false);\n}; // いいね一覧を取得\n\n\nconst handleGetLikes = async () => {\n  try {\n    const res = await getLikes();\n    console.log(res);\n\n    if ((res === null || res === void 0 ? void 0 : res.status) === 200) {\n      setLikedUsers(res === null || res === void 0 ? void 0 : res.data.activeLikes);\n    } else {\n      console.log(\"No likes\");\n    }\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nuseEffect(() => {\n  handleGetUsers();\n  handleGetLikes();\n}, []); // すでにいいねを押されているユーザーかどうかの判定\n\nconst isLikedUser = userId => {\n  return likedUsers === null || likedUsers === void 0 ? void 0 : likedUsers.some(likedUser => likedUser.id === userId);\n};\n\nexport default function UserModal() {\n  _s();\n\n  const classes = useStyles(); // getModalStyle is not a pure function, we roll the style only on the first render\n\n  const [modalStyle] = React.useState(getModalStyle);\n  const [open, setOpen] = React.useState(false);\n\n  const handleOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const body = /*#__PURE__*/_jsxDEV(\"div\", {\n    style: modalStyle,\n    className: classes.paper,\n    children: /*#__PURE__*/_jsxDEV(Dialog, {\n      open: userDetailOpen,\n      keepMounted: true,\n      onClose: () => setUserDetailOpen(false),\n      children: /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          justifyContent: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            children: /*#__PURE__*/_jsxDEV(Avatar, {\n              alt: \"avatar\",\n              src: user === null || user === void 0 ? void 0 : user.image.url,\n              className: classes.avatar\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          justifyContent: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            style: {\n              marginTop: \"1rem\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body1\",\n              component: \"p\",\n              gutterBottom: true,\n              style: {\n                textAlign: \"center\"\n              },\n              children: user.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              component: \"p\",\n              gutterBottom: true,\n              style: {\n                marginTop: \"0.5rem\",\n                fontWeight: \"bold\"\n              },\n              children: \"\\u81EA\\u5DF1\\u7D39\\u4ECB\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              component: \"p\",\n              color: \"textSecondary\",\n              style: {\n                marginTop: \"0.5rem\"\n              },\n              children: user.profile ? user.profile : \"よろしくお願いします。\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          justifyContent: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outlined\",\n            onClick: () => isLikedUser(user.id) ? void 0 : handleCreateLike(user),\n            color: \"secondary\",\n            startIcon: isLikedUser(user.id) ? /*#__PURE__*/_jsxDEV(FavoriteIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 49\n            }, this) : /*#__PURE__*/_jsxDEV(FavoriteBorderIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 68\n            }, this),\n            disabled: isLikedUser(user.id) ? true : false,\n            style: {\n              marginTop: \"1rem\",\n              marginBottom: \"1rem\"\n            },\n            children: isLikedUser(user.id) ? \"いいね済み\" : \"いいね\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 186,\n    columnNumber: 5\n  }, this);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      onClick: handleOpen,\n      variant: \"text\",\n      className: classes.button,\n      children: \"\\u30E6\\u30FC\\u30B6\\u30FC\\u306E\\u60C5\\u5831\\u3092\\u898B\\u308B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: open,\n      onClose: handleClose,\n      \"aria-labelledby\": \"simple-modal-title\",\n      \"aria-describedby\": \"simple-modal-description\",\n      children: body\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 239,\n    columnNumber: 5\n  }, this);\n}\n\n_s(UserModal, \"p+PfpQWRJSW5eCi9+wrB37XJE8A=\", false, function () {\n  return [useStyles];\n});\n\n_c = UserModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserModal\");","map":{"version":3,"sources":["/usr/src/app/src/components/post/UserModal.tsx"],"names":["React","useState","useEffect","useContext","makeStyles","createStyles","Modal","Grid","Typography","Dialog","DialogContent","Avatar","Button","Divider","FavoriteIcon","FavoriteBorderIcon","getUsers","getLikes","createLike","AuthContext","getModalStyle","top","left","transform","useStyles","theme","paper","position","width","backgroundColor","palette","background","border","boxShadow","shadows","padding","spacing","button","color","avatar","height","card","marginTop","transition","currentUser","initialUserState","id","uid","provider","email","name","image","url","profile","allowPasswordChange","loading","setLoading","users","setUsers","user","setUser","userDetailOpen","setUserDetailOpen","likedUsers","setLikedUsers","likes","setLikes","alertMessageOpen","setAlertMessageOpen","createFormData","formData","FormData","append","String","handleCreateLike","data","res","console","log","status","like","isMatched","err","handleGetUsers","handleGetLikes","activeLikes","isLikedUser","userId","some","likedUser","UserModal","classes","modalStyle","open","setOpen","handleOpen","handleClose","body","textAlign","fontWeight","marginBottom"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\"\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles';\nimport Modal from '@material-ui/core/Modal';\n\nimport { Grid, Typography } from \"@material-ui/core\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\n\nimport Avatar from \"@material-ui/core/Avatar\"\nimport Button from \"@material-ui/core/Button\"\nimport Divider from \"@material-ui/core/Divider\"\nimport FavoriteIcon from \"@material-ui/icons/Favorite\"\nimport FavoriteBorderIcon from \"@material-ui/icons/FavoriteBorder\"\nimport { LikeFormData } from \"interfaces/index\"\nimport AlertMessage from \"components/utils/AlertMessage\"\n\nimport { getUsers } from \"lib/api/users\"\nimport { getLikes, createLike } from \"lib/api/likes\"\nimport { User, LikeData } from \"interfaces/index\"\nimport { AuthContext } from \"App\"\n\nfunction getModalStyle() {\n  const top = 50\n  const left = 50\n\n  return {\n    top: `${top}%`,\n    left: `${left}%`,\n    transform: `translate(-${top}%, -${left}%)`,\n  };\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    paper: {\n      position: 'absolute',\n      width: 480,\n      backgroundColor: theme.palette.background.paper,\n      border: '2px solid #000',\n      boxShadow: theme.shadows[5],\n      padding: theme.spacing(6, 8, 7),\n    },\n    button: {\n      color: \"#f87ede\",\n    },\n    avatar: {\n      width: theme.spacing(10),\n      height: theme.spacing(10)\n    },\n    card: {\n      width: 480,\n      marginTop: \"2rem\",\n      transition: \"all 0.3s\",\n      \"&:hover\": {\n        boxShadow:\n          \"1px 0px 20px -1px rgba(0,0,0,0.2), 0px 0px 20px 5px rgba(0,0,0,0.14), 0px 1px 10px 0px rgba(0,0,0,0.12)\",\n        transform: \"translateY(-3px)\"\n      }\n    },\n  }),\n);\n\nconst { currentUser } = useContext(AuthContext)\n\nconst initialUserState: User = {\n  id: 0,\n  uid: \"\",\n  provider: \"\",\n  email: \"\",\n  name: \"\",\n  image: {\n    url: \"\"\n  },\n  profile: \"\",\n  allowPasswordChange: true\n}\n\nconst [loading, setLoading] = useState<boolean>(true)\nconst [users, setUsers] = useState<User[]>([])\nconst [user, setUser] = useState<User>(initialUserState)\nconst [userDetailOpen, setUserDetailOpen] = useState<boolean>(false)\nconst [likedUsers, setLikedUsers] = useState<User[]>([])\nconst [likes, setLikes] = useState<LikeData[]>([])\nconst [alertMessageOpen, setAlertMessageOpen] = useState<boolean>(false)\n\n// フォームデータを作成\nconst createFormData = (): LikeFormData => {\n  const formData = new FormData()\n\n  formData.append(\"fromUserId\", String(currentUser?.id))\n  formData.append(\"toUserId\", String(user.id))\n\n  return formData\n}\n\n// いいね作成\nconst handleCreateLike = async (user: User) => {\n\n  const data = createFormData()\n\n  try {\n    const res = await createLike(data)\n    console.log(res)\n\n    if (res?.status === 200) {\n      setLikes([res.data.like, ...likes])\n      setLikedUsers([user, ...likedUsers])\n\n      console.log(res?.data.like)\n    } else {\n      console.log(\"Failed\")\n    }\n\n    if (res?.data.isMatched === true) {\n      setAlertMessageOpen(true)\n      setUserDetailOpen(false)\n    }\n  } catch (err) {\n    console.log(err)\n  }\n}\n\n// ユーザー一覧を取得\nconst handleGetUsers = async () => {\n  try {\n    const res = await getUsers()\n    console.log(res)\n\n    if (res?.status === 200) {\n      setUsers(res?.data.users)\n    } else {\n      console.log(\"No users\")\n    }\n  } catch (err) {\n    console.log(err)\n  }\n\n  setLoading(false)\n}\n\n// いいね一覧を取得\nconst handleGetLikes = async () => {\n  try {\n    const res = await getLikes()\n    console.log(res)\n\n    if (res?.status === 200) {\n      setLikedUsers(res?.data.activeLikes)\n    } else {\n      console.log(\"No likes\")\n    }\n  } catch (err) {\n    console.log(err)\n  }\n}\n\nuseEffect(() => {\n  handleGetUsers()\n  handleGetLikes()\n}, [])\n\n// すでにいいねを押されているユーザーかどうかの判定\nconst isLikedUser = (userId: number | undefined): boolean => {\n  return likedUsers?.some((likedUser: User) => likedUser.id === userId)\n}\n\nexport default function UserModal() {\n  const classes = useStyles();\n  // getModalStyle is not a pure function, we roll the style only on the first render\n  const [modalStyle] = React.useState(getModalStyle);\n  const [open, setOpen] = React.useState(false);\n\n\n  const handleOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n\n\n\n  const body = (\n    <div style={modalStyle} className={classes.paper}>\n      <Dialog\n        open={userDetailOpen}\n        keepMounted\n        onClose={() => setUserDetailOpen(false)}\n      >\n        <DialogContent>\n          <Grid container justifyContent=\"center\">\n            <Grid item>\n              <Avatar\n                alt=\"avatar\"\n                src={user?.image.url}\n                className={classes.avatar}\n              />\n            </Grid>\n          </Grid>\n          <Grid container justifyContent=\"center\">\n            <Grid item style={{ marginTop: \"1rem\" }}>\n              <Typography variant=\"body1\" component=\"p\" gutterBottom style={{ textAlign: \"center\" }}>\n                {user.name}\n              </Typography>\n              <Divider />\n              <Typography\n                variant=\"body2\"\n                component=\"p\"\n                gutterBottom\n                style={{ marginTop: \"0.5rem\", fontWeight: \"bold\" }}\n              >\n                自己紹介\n              </Typography>\n              <Typography variant=\"body2\" component=\"p\" color=\"textSecondary\" style={{ marginTop: \"0.5rem\" }}>\n                {user.profile ? user.profile : \"よろしくお願いします。\"}\n              </Typography>\n            </Grid>\n          </Grid>\n          <Grid container justifyContent=\"center\">\n            <Button\n              variant=\"outlined\"\n              onClick={() => isLikedUser(user.id) ? void (0) : handleCreateLike(user)}\n              color=\"secondary\"\n              startIcon={isLikedUser(user.id) ? <FavoriteIcon /> : <FavoriteBorderIcon />}\n              disabled={isLikedUser(user.id) ? true : false}\n              style={{ marginTop: \"1rem\", marginBottom: \"1rem\" }}\n            >\n              {isLikedUser(user.id) ? \"いいね済み\" : \"いいね\"}\n            </Button>\n          </Grid>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n\n  return (\n    <div>\n      <Button\n        onClick={handleOpen}\n        variant=\"text\"\n        className={classes.button}\n      >\n        ユーザーの情報を見る\n      </Button>\n      <Modal\n        open={open}\n        onClose={handleClose}\n        aria-labelledby=\"simple-modal-title\"\n        aria-describedby=\"simple-modal-description\"\n      >\n        {body}\n      </Modal>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}