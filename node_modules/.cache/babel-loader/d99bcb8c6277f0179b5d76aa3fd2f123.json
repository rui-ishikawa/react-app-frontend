{"ast":null,"code":"var _jsxFileName = \"/usr/src/app/src/components/post/UserModal.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport { Grid, Typography } from \"@material-ui/core\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Button from \"@material-ui/core/Button\";\nimport Divider from \"@material-ui/core/Divider\";\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\nimport FavoriteBorderIcon from \"@material-ui/icons/FavoriteBorder\";\nimport { getUsers } from \"lib/api/users\";\nimport { getLikes, createLike } from \"lib/api/likes\";\nimport { AuthContext } from \"App\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => createStyles({\n  paper: {\n    position: 'absolute',\n    width: 480,\n    backgroundColor: theme.palette.background.paper,\n    border: '2px solid #000',\n    boxShadow: theme.shadows[5],\n    padding: theme.spacing(6, 8, 7)\n  },\n  button: {\n    color: \"#f87ede\"\n  },\n  avatar: {\n    width: theme.spacing(10),\n    height: theme.spacing(10)\n  },\n  card: {\n    width: 480,\n    marginTop: \"2rem\",\n    transition: \"all 0.3s\",\n    \"&:hover\": {\n      boxShadow: \"1px 0px 20px -1px rgba(0,0,0,0.2), 0px 0px 20px 5px rgba(0,0,0,0.14), 0px 1px 10px 0px rgba(0,0,0,0.12)\",\n      transform: \"translateY(-3px)\"\n    }\n  }\n}));\n\nconst UserModal = () => {\n  _s();\n\n  const classes = useStyles();\n  const {\n    currentUser\n  } = useContext(AuthContext);\n  const initialUserState = {\n    id: 0,\n    uid: \"\",\n    provider: \"\",\n    email: \"\",\n    name: \"\",\n    image: {\n      url: \"\"\n    },\n    profile: \"\",\n    allowPasswordChange: true\n  };\n  const [loading, setLoading] = useState(true);\n  const [users, setUsers] = useState([]);\n  const [user, setUser] = useState(initialUserState);\n  const [userDetailOpen, setUserDetailOpen] = useState(false);\n  const [likedUsers, setLikedUsers] = useState([]);\n  const [likes, setLikes] = useState([]);\n  const [alertMessageOpen, setAlertMessageOpen] = useState(false); // フォームデータを作成\n\n  const createFormData = () => {\n    const formData = new FormData();\n    formData.append(\"fromUserId\", String(currentUser === null || currentUser === void 0 ? void 0 : currentUser.id));\n    formData.append(\"toUserId\", String(user.id));\n    return formData;\n  }; // いいね作成\n\n\n  const handleCreateLike = async user => {\n    const data = createFormData();\n\n    try {\n      const res = await createLike(data);\n      console.log(res);\n\n      if ((res === null || res === void 0 ? void 0 : res.status) === 200) {\n        setLikes([res.data.like, ...likes]);\n        setLikedUsers([user, ...likedUsers]);\n        console.log(res === null || res === void 0 ? void 0 : res.data.like);\n      } else {\n        console.log(\"Failed\");\n      }\n\n      if ((res === null || res === void 0 ? void 0 : res.data.isMatched) === true) {\n        setAlertMessageOpen(true);\n        setUserDetailOpen(false);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  }; // ユーザー一覧を取得\n\n\n  const handleGetUsers = async () => {\n    try {\n      const res = await getUsers();\n      console.log(res);\n\n      if ((res === null || res === void 0 ? void 0 : res.status) === 200) {\n        setUsers(res === null || res === void 0 ? void 0 : res.data.users);\n      } else {\n        console.log(\"No users\");\n      }\n    } catch (err) {\n      console.log(err);\n    }\n\n    setLoading(false);\n  }; // いいね一覧を取得\n\n\n  const handleGetLikes = async () => {\n    try {\n      const res = await getLikes();\n      console.log(res);\n\n      if ((res === null || res === void 0 ? void 0 : res.status) === 200) {\n        setLikedUsers(res === null || res === void 0 ? void 0 : res.data.activeLikes);\n      } else {\n        console.log(\"No likes\");\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  useEffect(() => {\n    handleGetUsers();\n    handleGetLikes();\n  }, []); // すでにいいねを押されているユーザーかどうかの判定\n\n  const isLikedUser = userId => {\n    return likedUsers === null || likedUsers === void 0 ? void 0 : likedUsers.some(likedUser => likedUser.id === userId);\n  };\n\n  const handleOpen = () => {\n    setUser(user);\n    setUserDetailOpen(true);\n  };\n\n  const handleClose = () => {\n    setUserDetailOpen(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [users === null || users === void 0 ? void 0 : users.map((user, index) => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: () => {\n          setUser(user);\n          setUserDetailOpen(true);\n        },\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleOpen,\n          variant: \"text\",\n          className: classes.button,\n          children: \"\\u30E6\\u30FC\\u30B6\\u30FC\\u306E\\u60C5\\u5831\\u3092\\u898B\\u308B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 15\n        }, this)\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 13\n      }, this);\n    }), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(Dialog, {\n        open: userDetailOpen,\n        onClose: handleClose,\n        keepMounted: true,\n        children: /*#__PURE__*/_jsxDEV(DialogContent, {\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            justifyContent: \"center\",\n            children: /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              children: /*#__PURE__*/_jsxDEV(Avatar, {\n                alt: \"avatar\",\n                src: user === null || user === void 0 ? void 0 : user.image.url,\n                className: classes.avatar\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            justifyContent: \"center\",\n            children: /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              style: {\n                marginTop: \"1rem\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"body1\",\n                component: \"p\",\n                gutterBottom: true,\n                style: {\n                  textAlign: \"center\"\n                },\n                children: user.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"body2\",\n                component: \"p\",\n                gutterBottom: true,\n                style: {\n                  marginTop: \"0.5rem\",\n                  fontWeight: \"bold\"\n                },\n                children: \"\\u81EA\\u5DF1\\u7D39\\u4ECB\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"body2\",\n                component: \"p\",\n                color: \"textSecondary\",\n                style: {\n                  marginTop: \"0.5rem\"\n                },\n                children: user.profile ? user.profile : \"よろしくお願いします。\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 224,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            justifyContent: \"center\",\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"outlined\",\n              onClick: () => isLikedUser(user.id) ? void 0 : handleCreateLike(user),\n              color: \"secondary\",\n              startIcon: isLikedUser(user.id) ? /*#__PURE__*/_jsxDEV(FavoriteIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 51\n              }, this) : /*#__PURE__*/_jsxDEV(FavoriteBorderIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 70\n              }, this),\n              disabled: isLikedUser(user.id) ? true : false,\n              style: {\n                marginTop: \"1rem\",\n                marginBottom: \"1rem\"\n              },\n              children: isLikedUser(user.id) ? \"いいね済み\" : \"いいね\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(UserModal, \"HhYclTfMJAZJ3VUs3Um+rEbjhEk=\", false, function () {\n  return [useStyles];\n});\n\n_c = UserModal;\nexport default UserModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserModal\");","map":{"version":3,"sources":["/usr/src/app/src/components/post/UserModal.tsx"],"names":["React","useState","useEffect","useContext","makeStyles","createStyles","Grid","Typography","Dialog","DialogContent","Avatar","Button","Divider","FavoriteIcon","FavoriteBorderIcon","getUsers","getLikes","createLike","AuthContext","useStyles","theme","paper","position","width","backgroundColor","palette","background","border","boxShadow","shadows","padding","spacing","button","color","avatar","height","card","marginTop","transition","transform","UserModal","classes","currentUser","initialUserState","id","uid","provider","email","name","image","url","profile","allowPasswordChange","loading","setLoading","users","setUsers","user","setUser","userDetailOpen","setUserDetailOpen","likedUsers","setLikedUsers","likes","setLikes","alertMessageOpen","setAlertMessageOpen","createFormData","formData","FormData","append","String","handleCreateLike","data","res","console","log","status","like","isMatched","err","handleGetUsers","handleGetLikes","activeLikes","isLikedUser","userId","some","likedUser","handleOpen","handleClose","map","index","textAlign","fontWeight","marginBottom"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect, useContext } from \"react\"\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles';\n\nimport { Grid, Typography } from \"@material-ui/core\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\n\nimport Avatar from \"@material-ui/core/Avatar\"\nimport Button from \"@material-ui/core/Button\"\nimport Divider from \"@material-ui/core/Divider\"\nimport FavoriteIcon from \"@material-ui/icons/Favorite\"\nimport FavoriteBorderIcon from \"@material-ui/icons/FavoriteBorder\"\nimport { LikeFormData } from \"interfaces/index\"\nimport AlertMessage from \"components/utils/AlertMessage\"\n\nimport { getUsers } from \"lib/api/users\"\nimport { getLikes, createLike } from \"lib/api/likes\"\nimport { User, LikeData } from \"interfaces/index\"\nimport { AuthContext } from \"App\"\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    paper: {\n      position: 'absolute',\n      width: 480,\n      backgroundColor: theme.palette.background.paper,\n      border: '2px solid #000',\n      boxShadow: theme.shadows[5],\n      padding: theme.spacing(6, 8, 7),\n    },\n    button: {\n      color: \"#f87ede\",\n    },\n    avatar: {\n      width: theme.spacing(10),\n      height: theme.spacing(10)\n    },\n    card: {\n      width: 480,\n      marginTop: \"2rem\",\n      transition: \"all 0.3s\",\n      \"&:hover\": {\n        boxShadow:\n          \"1px 0px 20px -1px rgba(0,0,0,0.2), 0px 0px 20px 5px rgba(0,0,0,0.14), 0px 1px 10px 0px rgba(0,0,0,0.12)\",\n        transform: \"translateY(-3px)\"\n      }\n    },\n  }),\n);\n\nconst UserModal: React.FC = () => {\n  const classes = useStyles();\n  const { currentUser } = useContext(AuthContext)\n\n  const initialUserState: User = {\n    id: 0,\n    uid: \"\",\n    provider: \"\",\n    email: \"\",\n    name: \"\",\n    image: {\n      url: \"\"\n    },\n    profile: \"\",\n    allowPasswordChange: true\n  }\n\n  const [loading, setLoading] = useState<boolean>(true)\n  const [users, setUsers] = useState<User[]>([])\n  const [user, setUser] = useState<User>(initialUserState)\n  const [userDetailOpen, setUserDetailOpen] = useState<boolean>(false)\n  const [likedUsers, setLikedUsers] = useState<User[]>([])\n  const [likes, setLikes] = useState<LikeData[]>([])\n  const [alertMessageOpen, setAlertMessageOpen] = useState<boolean>(false)\n\n  // フォームデータを作成\n  const createFormData = (): LikeFormData => {\n    const formData = new FormData()\n\n    formData.append(\"fromUserId\", String(currentUser?.id))\n    formData.append(\"toUserId\", String(user.id))\n\n    return formData\n  }\n\n  // いいね作成\n  const handleCreateLike = async (user: User) => {\n\n    const data = createFormData()\n\n    try {\n      const res = await createLike(data)\n      console.log(res)\n\n      if (res?.status === 200) {\n        setLikes([res.data.like, ...likes])\n        setLikedUsers([user, ...likedUsers])\n\n        console.log(res?.data.like)\n      } else {\n        console.log(\"Failed\")\n      }\n\n      if (res?.data.isMatched === true) {\n        setAlertMessageOpen(true)\n        setUserDetailOpen(false)\n      }\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  // ユーザー一覧を取得\n  const handleGetUsers = async () => {\n    try {\n      const res = await getUsers()\n      console.log(res)\n\n      if (res?.status === 200) {\n        setUsers(res?.data.users)\n      } else {\n        console.log(\"No users\")\n      }\n    } catch (err) {\n      console.log(err)\n    }\n\n    setLoading(false)\n  }\n\n  // いいね一覧を取得\n  const handleGetLikes = async () => {\n    try {\n      const res = await getLikes()\n      console.log(res)\n\n      if (res?.status === 200) {\n        setLikedUsers(res?.data.activeLikes)\n      } else {\n        console.log(\"No likes\")\n      }\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  useEffect(() => {\n    handleGetUsers()\n    handleGetLikes()\n  }, [])\n\n  // すでにいいねを押されているユーザーかどうかの判定\n  const isLikedUser = (userId: number | undefined): boolean => {\n    return likedUsers?.some((likedUser: User) => likedUser.id === userId)\n  }\n\n\n  const handleOpen = () => {\n    setUser(user)\n    setUserDetailOpen(true);\n  };\n\n  const handleClose = () => {\n    setUserDetailOpen(false);\n  };\n\n\n\n\n\n  return (\n    <>\n      {\n        users?.map((user: User, index: number) => {\n          return (\n            <div key={index} onClick={() => {\n              setUser(user)\n              setUserDetailOpen(true)\n            }}>\n\n              <Button\n                onClick={handleOpen}\n                variant=\"text\"\n                className={classes.button}\n              >\n                ユーザーの情報を見る\n              </Button>\n            </div>\n          )\n        })\n      }\n\n\n      <div>\n        <Dialog\n          open={userDetailOpen}\n          onClose={handleClose}\n          keepMounted\n        >\n          <DialogContent>\n            <Grid container justifyContent=\"center\">\n              <Grid item>\n                <Avatar\n                  alt=\"avatar\"\n                  src={user?.image.url}\n                  className={classes.avatar}\n                />\n              </Grid>\n            </Grid>\n            <Grid container justifyContent=\"center\">\n              <Grid item style={{ marginTop: \"1rem\" }}>\n                <Typography variant=\"body1\" component=\"p\" gutterBottom style={{ textAlign: \"center\" }}>\n                  {user.name}\n                </Typography>\n                <Divider />\n                <Typography\n                  variant=\"body2\"\n                  component=\"p\"\n                  gutterBottom\n                  style={{ marginTop: \"0.5rem\", fontWeight: \"bold\" }}\n                >\n                  自己紹介\n                </Typography>\n                <Typography variant=\"body2\" component=\"p\" color=\"textSecondary\" style={{ marginTop: \"0.5rem\" }}>\n                  {user.profile ? user.profile : \"よろしくお願いします。\"}\n                </Typography>\n              </Grid>\n            </Grid>\n            <Grid container justifyContent=\"center\">\n              <Button\n                variant=\"outlined\"\n                onClick={() => isLikedUser(user.id) ? void (0) : handleCreateLike(user)}\n                color=\"secondary\"\n                startIcon={isLikedUser(user.id) ? <FavoriteIcon /> : <FavoriteBorderIcon />}\n                disabled={isLikedUser(user.id) ? true : false}\n                style={{ marginTop: \"1rem\", marginBottom: \"1rem\" }}\n              >\n                {isLikedUser(user.id) ? \"いいね済み\" : \"いいね\"}\n              </Button>\n            </Grid>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n\n\n    </>\n  )\n\n\n}\n\nexport default UserModal\n"]},"metadata":{},"sourceType":"module"}