{"ast":null,"code":"var _jsxFileName = \"/usr/src/app/src/components/pages/Home.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState, useCallback } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { motion } from \"framer-motion\";\nimport Cookies from \"js-cookie\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Grid, Typography } from \"@material-ui/core\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport SettingsIcon from \"@material-ui/icons/Settings\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport TextField from \"@material-ui/core/TextField\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport PhotoCamera from \"@material-ui/icons/PhotoCamera\";\nimport Box from \"@material-ui/core/Box\";\nimport CancelIcon from \"@material-ui/icons/Cancel\";\nimport ExitToAppIcon from \"@material-ui/icons/ExitToApp\";\nimport Button from \"@material-ui/core/Button\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Divider from \"@material-ui/core/Divider\";\nimport { AuthContext } from \"App\";\nimport { signOut } from \"lib/api/auth\";\nimport { updateUser } from \"lib/api/users\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  avatar: {\n    width: theme.spacing(10),\n    height: theme.spacing(10)\n  },\n  card: {\n    width: 340\n  },\n  imageUploadBtn: {\n    textAlign: \"right\"\n  },\n  input: {\n    display: \"none\"\n  },\n  box: {\n    marginBottom: \"1.5rem\"\n  },\n  preview: {\n    width: \"100%\"\n  }\n})); // ホーム（マイページ）\n\nconst Home = () => {\n  _s();\n\n  const {\n    isSignedIn,\n    setIsSignedIn,\n    currentUser,\n    setCurrentUser\n  } = useContext(AuthContext);\n  const classes = useStyles();\n  const history = useHistory();\n  const [editFormOpen, setEditFormOpen] = useState(false);\n  const [name, setName] = useState(currentUser === null || currentUser === void 0 ? void 0 : currentUser.name);\n  const [profile, setProfile] = useState(currentUser === null || currentUser === void 0 ? void 0 : currentUser.profile);\n  const [image, setImage] = useState(\"\");\n  const [preview, setPreview] = useState(\"\"); // アップロードした画像の情報を取得\n\n  const uploadImage = useCallback(e => {\n    const file = e.target.files[0];\n    setImage(file);\n  }, []); // 画像プレビュー\n\n  const previewImage = useCallback(e => {\n    const file = e.target.files[0];\n    setPreview(window.URL.createObjectURL(file));\n  }, []);\n\n  const createFormData = () => {\n    const formData = new FormData();\n    formData.append(\"name\", name || \"\");\n    formData.append(\"profile\", profile || \"\");\n    formData.append(\"image\", image);\n    return formData;\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const data = createFormData();\n\n    try {\n      const res = await updateUser(currentUser === null || currentUser === void 0 ? void 0 : currentUser.id, data);\n      console.log(res);\n\n      if (res.status === 200) {\n        setEditFormOpen(false);\n        setCurrentUser(res.data.user);\n        console.log(\"Update user successfully!\");\n      } else {\n        console.log(res.data.message);\n      }\n    } catch (err) {\n      console.log(err);\n      console.log(\"Failed in updating user!\");\n    }\n  }; // サインアウト用の処理\n\n\n  const handleSignOut = async e => {\n    try {\n      const res = await signOut();\n\n      if (res.data.success === true) {\n        // Cookieから各情報を削除\n        Cookies.remove(\"_access_token\");\n        Cookies.remove(\"_client\");\n        Cookies.remove(\"_uid\");\n        setIsSignedIn(false);\n        history.push(\"/signin\");\n        console.log(\"Succeeded in sign out\");\n      } else {\n        console.log(\"Failed in sign out\");\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: isSignedIn && currentUser ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(motion.div, {\n        animate: {\n          x: 0\n        },\n        initial: {\n          x: 800\n        },\n        exit: {\n          x: -800\n        },\n        transition: {\n          duration: 0.4\n        },\n        children: [/*#__PURE__*/_jsxDEV(Card, {\n          className: classes.card,\n          children: /*#__PURE__*/_jsxDEV(CardContent, {\n            children: [/*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              justifyContent: \"flex-end\",\n              children: /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                children: /*#__PURE__*/_jsxDEV(IconButton, {\n                  onClick: () => setEditFormOpen(true),\n                  children: /*#__PURE__*/_jsxDEV(SettingsIcon, {\n                    color: \"action\",\n                    fontSize: \"small\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 155,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              justifyContent: \"center\",\n              children: /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                children: /*#__PURE__*/_jsxDEV(Avatar, {\n                  alt: \"avatar\",\n                  src: currentUser === null || currentUser === void 0 ? void 0 : currentUser.image.url,\n                  className: classes.avatar\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              justifyContent: \"center\",\n              children: /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                style: {\n                  marginTop: \"1.5rem\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body1\",\n                  component: \"p\",\n                  gutterBottom: true,\n                  children: currentUser === null || currentUser === void 0 ? void 0 : currentUser.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 173,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Divider, {\n                  style: {\n                    marginTop: \"0.5rem\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 176,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body2\",\n                  component: \"p\",\n                  gutterBottom: true,\n                  style: {\n                    marginTop: \"0.5rem\",\n                    fontWeight: \"bold\"\n                  },\n                  children: \"\\u81EA\\u5DF1\\u7D39\\u4ECB\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 177,\n                  columnNumber: 23\n                }, this), currentUser.profile ? /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body2\",\n                  component: \"p\",\n                  color: \"textSecondary\",\n                  children: currentUser.profile\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 27\n                }, this) : /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body2\",\n                  component: \"p\",\n                  color: \"textSecondary\",\n                  children: \"\\u3088\\u308D\\u3057\\u304F\\u304A\\u9858\\u3044\\u3044\\u305F\\u3057\\u307E\\u3059\\u3002\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 191,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"outlined\",\n                  onClick: handleSignOut,\n                  color: \"primary\",\n                  fullWidth: true,\n                  startIcon: /*#__PURE__*/_jsxDEV(ExitToAppIcon, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 201,\n                    columnNumber: 36\n                  }, this),\n                  style: {\n                    marginTop: \"1rem\"\n                  },\n                  children: \"\\u30B5\\u30A4\\u30F3\\u30A2\\u30A6\\u30C8\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 196,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          noValidate: true,\n          autoComplete: \"off\",\n          children: /*#__PURE__*/_jsxDEV(Dialog, {\n            open: editFormOpen,\n            keepMounted: true,\n            onClose: () => setEditFormOpen(false),\n            children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n              style: {\n                textAlign: \"center\"\n              },\n              children: \"\\u30D7\\u30ED\\u30D5\\u30A3\\u30FC\\u30EB\\u306E\\u5909\\u66F4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n              children: [/*#__PURE__*/_jsxDEV(TextField, {\n                variant: \"outlined\",\n                required: true,\n                fullWidth: true,\n                label: \"\\u540D\\u524D\",\n                value: name,\n                margin: \"dense\",\n                onChange: e => setName(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 220,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(TextField, {\n                placeholder: \"1000\\u6587\\u5B57\\u4EE5\\u5185\\u3067\\u66F8\\u3044\\u3066\\u304F\\u3060\\u3055\\u3044\\u3002\",\n                variant: \"outlined\",\n                multiline: true,\n                fullWidth: true,\n                label: \"\\u81EA\\u5DF1\\u7D39\\u4ECB\",\n                rows: \"8\",\n                value: profile,\n                margin: \"dense\",\n                onChange: e => {\n                  setProfile(e.target.value);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: classes.imageUploadBtn,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  accept: \"image/*\",\n                  className: classes.input,\n                  id: \"icon-button-file\",\n                  type: \"file\",\n                  onChange: e => {\n                    uploadImage(e);\n                    previewImage(e);\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 243,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"icon-button-file\",\n                  children: /*#__PURE__*/_jsxDEV(IconButton, {\n                    color: \"primary\",\n                    \"aria-label\": \"upload picture\",\n                    component: \"span\",\n                    children: /*#__PURE__*/_jsxDEV(PhotoCamera, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 259,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 254,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 21\n              }, this), preview ? /*#__PURE__*/_jsxDEV(Box, {\n                className: classes.box,\n                children: [/*#__PURE__*/_jsxDEV(IconButton, {\n                  color: \"inherit\",\n                  onClick: () => setPreview(\"\"),\n                  children: /*#__PURE__*/_jsxDEV(CancelIcon, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 272,\n                    columnNumber: 29\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 268,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: preview,\n                  alt: \"preview img\",\n                  className: classes.preview\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 274,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 265,\n                columnNumber: 25\n              }, this) : null]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                onClick: handleSubmit,\n                color: \"primary\",\n                disabled: !name || !profile ? true : false,\n                children: \"\\u9001\\u4FE1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 13\n      }, this)\n    }, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)\n  }, void 0, false);\n};\n\n_s(Home, \"Q9tVVmqOG67XOUxmJ7Ib26NB2kU=\", false, function () {\n  return [useStyles, useHistory];\n});\n\n_c = Home;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["/usr/src/app/src/components/pages/Home.tsx"],"names":["React","useContext","useState","useCallback","useHistory","motion","Cookies","makeStyles","Grid","Typography","Card","CardContent","IconButton","SettingsIcon","Dialog","TextField","DialogActions","DialogContent","DialogTitle","PhotoCamera","Box","CancelIcon","ExitToAppIcon","Button","Avatar","Divider","AuthContext","signOut","updateUser","useStyles","theme","avatar","width","spacing","height","card","imageUploadBtn","textAlign","input","display","box","marginBottom","preview","Home","isSignedIn","setIsSignedIn","currentUser","setCurrentUser","classes","history","editFormOpen","setEditFormOpen","name","setName","profile","setProfile","image","setImage","setPreview","uploadImage","e","file","target","files","previewImage","window","URL","createObjectURL","createFormData","formData","FormData","append","handleSubmit","preventDefault","data","res","id","console","log","status","user","message","err","handleSignOut","success","remove","push","x","duration","url","marginTop","fontWeight","value"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useCallback } from \"react\"\nimport { useHistory } from \"react-router-dom\"\nimport { motion } from \"framer-motion\";\nimport Cookies from \"js-cookie\"\n\nimport { makeStyles, Theme } from \"@material-ui/core/styles\"\nimport { Grid, Typography } from \"@material-ui/core\"\nimport Card from \"@material-ui/core/Card\"\nimport CardContent from \"@material-ui/core/CardContent\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport SettingsIcon from \"@material-ui/icons/Settings\"\n\nimport Dialog from \"@material-ui/core/Dialog\"\nimport TextField from \"@material-ui/core/TextField\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\n\nimport PhotoCamera from \"@material-ui/icons/PhotoCamera\"\nimport Box from \"@material-ui/core/Box\"\nimport CancelIcon from \"@material-ui/icons/Cancel\"\nimport ExitToAppIcon from \"@material-ui/icons/ExitToApp\"\nimport Button from \"@material-ui/core/Button\"\n\nimport Avatar from \"@material-ui/core/Avatar\"\nimport Divider from \"@material-ui/core/Divider\"\n\nimport { AuthContext } from \"App\"\n\n\nimport { signOut } from \"lib/api/auth\"\nimport { updateUser } from \"lib/api/users\"\nimport { UpdateUserFormData } from \"interfaces/index\"\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  avatar: {\n    width: theme.spacing(10),\n    height: theme.spacing(10)\n  },\n  card: {\n    width: 340\n  },\n  imageUploadBtn: {\n    textAlign: \"right\"\n  },\n  input: {\n    display: \"none\"\n  },\n  box: {\n    marginBottom: \"1.5rem\"\n  },\n  preview: {\n    width: \"100%\"\n  }\n}))\n\n// ホーム（マイページ）\nconst Home: React.FC = () => {\n  const { isSignedIn, setIsSignedIn, currentUser, setCurrentUser } = useContext(AuthContext)\n\n  const classes = useStyles()\n  const history = useHistory()\n\n  const [editFormOpen, setEditFormOpen] = useState<boolean>(false)\n  const [name, setName] = useState<string | undefined>(currentUser?.name)\n  const [profile, setProfile] = useState<string | undefined>(currentUser?.profile)\n  const [image, setImage] = useState<string>(\"\")\n  const [preview, setPreview] = useState<string>(\"\")\n\n  // アップロードした画像の情報を取得\n  const uploadImage = useCallback((e) => {\n    const file = e.target.files[0]\n    setImage(file)\n  }, [])\n\n  // 画像プレビュー\n  const previewImage = useCallback((e) => {\n    const file = e.target.files[0]\n    setPreview(window.URL.createObjectURL(file))\n  }, [])\n\n  const createFormData = (): UpdateUserFormData => {\n    const formData = new FormData()\n\n    formData.append(\"name\", name || \"\")\n    formData.append(\"profile\", profile || \"\")\n    formData.append(\"image\", image)\n\n    return formData\n  }\n\n  const handleSubmit = async (e: React.MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault()\n\n    const data = createFormData()\n\n    try {\n      const res = await updateUser(currentUser?.id, data)\n      console.log(res)\n\n      if (res.status === 200) {\n        setEditFormOpen(false)\n        setCurrentUser(res.data.user)\n\n        console.log(\"Update user successfully!\")\n      } else {\n        console.log(res.data.message)\n      }\n    } catch (err) {\n      console.log(err)\n      console.log(\"Failed in updating user!\")\n    }\n  }\n\n  // サインアウト用の処理\n  const handleSignOut = async (e: React.MouseEvent<HTMLButtonElement>) => {\n    try {\n      const res = await signOut()\n\n      if (res.data.success === true) {\n        // Cookieから各情報を削除\n        Cookies.remove(\"_access_token\")\n        Cookies.remove(\"_client\")\n        Cookies.remove(\"_uid\")\n\n        setIsSignedIn(false)\n        history.push(\"/signin\")\n\n        console.log(\"Succeeded in sign out\")\n      } else {\n        console.log(\"Failed in sign out\")\n      }\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  return (\n    <>\n      {\n        isSignedIn && currentUser ? (\n          <>\n            <motion.div\n              animate={{ x: 0 }}\n              initial={{ x: 800 }}\n              exit={{ x: -800 }}\n              transition={{ duration: 0.4 }}>\n              <Card className={classes.card}>\n                <CardContent>\n                  <Grid container justifyContent=\"flex-end\">\n                    <Grid item>\n                      <IconButton\n                        onClick={() => setEditFormOpen(true)}\n                      >\n                        <SettingsIcon\n                          color=\"action\"\n                          fontSize=\"small\"\n                        />\n                      </IconButton>\n                    </Grid>\n                  </Grid>\n                  <Grid container justifyContent=\"center\">\n                    <Grid item>\n                      <Avatar\n                        alt=\"avatar\"\n                        src={currentUser?.image.url}\n                        className={classes.avatar}\n                      />\n                    </Grid>\n                  </Grid>\n                  <Grid container justifyContent=\"center\">\n                    <Grid item style={{ marginTop: \"1.5rem\" }}>\n                      <Typography variant=\"body1\" component=\"p\" gutterBottom>\n                        {currentUser?.name}\n                      </Typography>\n                      <Divider style={{ marginTop: \"0.5rem\" }} />\n                      <Typography\n                        variant=\"body2\"\n                        component=\"p\"\n                        gutterBottom\n                        style={{ marginTop: \"0.5rem\", fontWeight: \"bold\" }}\n                      >\n                        自己紹介\n                    </Typography>\n                      {\n                        currentUser.profile ? (\n                          <Typography variant=\"body2\" component=\"p\" color=\"textSecondary\">\n                            {currentUser.profile}\n                          </Typography>\n                        ) : (\n                          <Typography variant=\"body2\" component=\"p\" color=\"textSecondary\">\n                            よろしくお願いいたします。\n                          </Typography>\n                        )\n                      }\n                      <Button\n                        variant=\"outlined\"\n                        onClick={handleSignOut}\n                        color=\"primary\"\n                        fullWidth\n                        startIcon={<ExitToAppIcon />}\n                        style={{ marginTop: \"1rem\" }}\n                      >\n                        サインアウト\n                    </Button>\n                    </Grid>\n                  </Grid>\n                </CardContent>\n              </Card>\n              <form noValidate autoComplete=\"off\">\n                <Dialog\n                  open={editFormOpen}\n                  keepMounted\n                  onClose={() => setEditFormOpen(false)}\n                >\n                  <DialogTitle style={{ textAlign: \"center\" }}>\n                    プロフィールの変更\n                </DialogTitle>\n                  <DialogContent>\n                    <TextField\n                      variant=\"outlined\"\n                      required\n                      fullWidth\n                      label=\"名前\"\n                      value={name}\n                      margin=\"dense\"\n                      onChange={(e: React.ChangeEvent<HTMLInputElement>) => setName(e.target.value)}\n                    />\n                    <TextField\n                      placeholder=\"1000文字以内で書いてください。\"\n                      variant=\"outlined\"\n                      multiline\n                      fullWidth\n                      label=\"自己紹介\"\n                      rows=\"8\"\n                      value={profile}\n                      margin=\"dense\"\n                      onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                        setProfile(e.target.value)\n                      }}\n                    />\n                    <div className={classes.imageUploadBtn}>\n                      <input\n                        accept=\"image/*\"\n                        className={classes.input}\n                        id=\"icon-button-file\"\n                        type=\"file\"\n                        onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                          uploadImage(e)\n                          previewImage(e)\n                        }}\n                      />\n                      <label htmlFor=\"icon-button-file\">\n                        <IconButton\n                          color=\"primary\"\n                          aria-label=\"upload picture\"\n                          component=\"span\"\n                        >\n                          <PhotoCamera />\n                        </IconButton>\n                      </label>\n                    </div>\n                    {\n                      preview ? (\n                        <Box\n                          className={classes.box}\n                        >\n                          <IconButton\n                            color=\"inherit\"\n                            onClick={() => setPreview(\"\")}\n                          >\n                            <CancelIcon />\n                          </IconButton>\n                          <img\n                            src={preview}\n                            alt=\"preview img\"\n                            className={classes.preview}\n                          />\n                        </Box>\n                      ) : null\n                    }\n                  </DialogContent>\n                  <DialogActions>\n                    <Button\n                      onClick={handleSubmit}\n                      color=\"primary\"\n                      disabled={!name || !profile ? true : false}\n                    >\n                      送信\n                  </Button>\n                  </DialogActions>\n                </Dialog>\n              </form>\n            </motion.div>\n          </>\n        ) : (\n          <></>\n        )\n      }\n    </>\n  )\n}\n\nexport default Home\n"]},"metadata":{},"sourceType":"module"}